# langchain(3)—向量数据库调研及简单性能测试

完整文章可以参考知乎文章：https://zhuanlan.zhihu.com/p/644105925

## 主要实现faiss和milvus的简单性能测试

1. 测试数据：使用了刘焕勇老师的 ChineseTextualInference项目数据，其中包含了88万条中文文本信息。
2. 测试模型：使用了的 shibing624/text2vec-base-chinese 文本转向量模型，将文本转唯768维的向量。
3. 运行：
    * 需要先将数据放入datas目录下，将向量模型放入models目录下
    * 先运行一边milvus_test.py，注意要将连接方式改为自己的，从而生成向量数据。经过测试，如果是超过15万条的向量规模，无法一次性插入到milvus数据库中，需要分批
    * 然后在运行faiss_test.py查看对比效果，需要安装faiss-cpu
    * 配置说明：服务器，加载到内存上，GPU机器（内存100G，cpu核数30），只使用cpu进行查询。
4. 效果：
    * milvus：
      * 插入50万条768维的文本向量耗时：100 秒
      * 构建50万条索引耗时：52 秒
      * 加载数据耗时平均：22.8 秒
      * 50万条向量规模的平均查询耗时：200毫秒【1w的数据也是，查询效率不变】
    * faiss：
      * 50万条向量插入速度：1s，生成index文件很快
      * 50万条平均查询速度：130ms

5. 注：以上结果要根据自己的机器、向量维度、甚至milvus版本、使用的索引类型等不同而决定，提供思路和代码，不作为最终应用参考。